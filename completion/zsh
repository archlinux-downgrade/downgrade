#compdef downgrade

_downgrade(){
  _arguments -S -C '*:packages:->pkg' \
             '--pacman[Specify pacman command]' \
             '--pacman-conf[Specify pacman configuration file]:config:_files' \
             '--ala-url[Specify location of ALA server]' \
             '--ala-only[Option enables only ALA server search]' \
             '--cached-only[Option enables only cached search]' \
             '--nosudo[Option enables only su even when sudo is present]' \
             {-h,--help}'[Show help]'

  if [[ $state == "pkg" ]] && [[ ! $words =~ "\s\-\-\s" ]]; then
    local -a packages
    packages=($(pacman -Qsq "^$words[current]" 2>/dev/null))
    _describe 'packages' packages
  fi
}

_downgrade "$@"
# vim: syntax=Shell
